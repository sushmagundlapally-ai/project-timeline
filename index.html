<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Timeline - Workstream Tracker</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1>üìä Project Timeline</h1>
                <p class="subtitle">Workstream & Task Tracker</p>
            </div>
            <div class="header-actions">
                <div class="calendar-range">
                    <label>üìÖ</label>
                    <input type="month" id="startMonth" title="Start Month">
                    <span>to</span>
                    <input type="month" id="endMonth" title="End Month">
                </div>
                <button class="btn-icon" id="addWorkstreamBtn" title="Add Workstream">‚ûï</button>
                <button class="btn-icon" id="exportCSVBtn" title="Export to Google Sheets (CSV)">üìä</button>
                <button class="btn-icon" id="importGoogleBtn" title="Import from Google Sheets">
                    <img src="https://www.gstatic.com/images/branding/product/1x/sheets_2020q4_48dp.png" alt="Sheets" style="width: 20px; height: 20px;">
                </button>
                <button class="btn-icon" id="importBtn" title="Import Local File">üì§</button>
                <input type="file" id="importFile" accept=".json,.csv" style="display: none;">
            </div>
        </header>

        <!-- Legend -->
        <div class="legend">
            <div class="legend-item">
                <span class="legend-color p0"></span>
                <span>P0 - Critical</span>
            </div>
            <div class="legend-item">
                <span class="legend-color p1"></span>
                <span>P1 - High</span>
            </div>
            <div class="legend-item">
                <span class="legend-color p2"></span>
                <span>P2 - Medium</span>
            </div>
            <div class="legend-item">
                <span class="legend-size">S</span>
                <span>Small</span>
            </div>
            <div class="legend-item">
                <span class="legend-size">M</span>
                <span>Medium</span>
            </div>
            <div class="legend-item">
                <span class="legend-size">L</span>
                <span>Large</span>
            </div>
        </div>

        <!-- Timeline Container -->
        <div class="timeline-wrapper">
            <div class="timeline-container" id="timelineContainer">
                <!-- Timeline Header with Months -->
                <div class="timeline-header" id="timelineHeader">
                    <div class="workstream-label-header">WORKSTREAM / TASK</div>
                    <div class="months-header" id="monthsHeader">
                        <!-- Months will be generated by JS -->
                    </div>
                </div>

                <!-- Timeline Body -->
                <div class="timeline-body" id="timelineBody">
                    <!-- Workstreams and tasks will be rendered here -->
                </div>
            </div>
        </div>

        <!-- Add/Edit Modal -->
        <div class="modal" id="taskModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="modalTitle">Add Task</h2>
                    <button class="modal-close" onclick="closeModal()">&times;</button>
                </div>
                <form id="taskForm">
                    <div class="form-group">
                        <label for="taskName">Task Name</label>
                        <input type="text" id="taskName" required placeholder="Enter task name">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="taskPriority">Priority</label>
                            <select id="taskPriority">
                                <option value="P0">P0 - Critical</option>
                                <option value="P1">P1 - High</option>
                                <option value="P2">P2 - Medium</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="taskSize">Size</label>
                            <select id="taskSize">
                                <option value="S">S - Small</option>
                                <option value="M">M - Medium</option>
                                <option value="L">L - Large</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="taskStart">Start Date</label>
                            <input type="date" id="taskStart" required>
                        </div>
                        <div class="form-group">
                            <label for="taskEnd">End Date</label>
                            <input type="date" id="taskEnd" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="taskRisk">Risk Level</label>
                            <select id="taskRisk">
                                <option value="none">None</option>
                                <option value="low">Low ‚ö†Ô∏è</option>
                                <option value="medium">Medium üî∂</option>
                                <option value="high">High üî∫</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="taskOwner">Owner</label>
                            <input type="text" id="taskOwner" placeholder="Enter owner name">
                        </div>
                    </div>
                    <div class="form-group" id="riskTextGroup" style="display: none;">
                        <label for="taskRiskText">Risk Description</label>
                        <textarea id="taskRiskText" rows="2" placeholder="Describe the risk..."></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-cancel" onclick="closeModal()">Cancel</button>
                        <button type="submit" class="btn-save">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Add Workstream Modal -->
        <div class="modal" id="workstreamModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Add Workstream</h2>
                    <button class="modal-close" onclick="closeWorkstreamModal()">&times;</button>
                </div>
                <form id="workstreamForm">
                    <div class="form-group">
                        <label for="workstreamName">Workstream Name</label>
                        <input type="text" id="workstreamName" required placeholder="Enter workstream name">
                    </div>
                    <div class="form-group">
                        <label for="workstreamOwner">Owner</label>
                        <input type="text" id="workstreamOwner" placeholder="Enter owner name">
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-cancel" onclick="closeWorkstreamModal()">Cancel</button>
                        <button type="submit" class="btn-save">Add Workstream</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Google Sheets Import Modal -->
        <div class="modal" id="googleSheetsModal">
            <div class="modal-content" style="max-width: 550px;">
                <div class="modal-header">
                    <h2>üìä Import from Google Sheets</h2>
                    <button class="modal-close" onclick="closeGoogleModal()">&times;</button>
                </div>
                <div class="google-import-content">
                    <div class="import-tabs">
                        <button class="import-tab active" onclick="switchImportTab('url')">üîó Sheet URL</button>
                        <button class="import-tab" onclick="switchImportTab('paste')">üìã Paste Data</button>
                    </div>
                    
                    <div id="urlTab" class="import-tab-content active">
                        <div class="import-instructions">
                            <p><strong>How to get your Sheet URL:</strong></p>
                            <ol>
                                <li>Open your Google Sheet</li>
                                <li>Go to <strong>File ‚Üí Share ‚Üí Publish to web</strong></li>
                                <li>Select <strong>Comma-separated values (.csv)</strong></li>
                                <li>Click <strong>Publish</strong> and copy the URL</li>
                            </ol>
                        </div>
                        <div class="form-group">
                            <label for="googleSheetUrl">Published CSV URL</label>
                            <input type="url" id="googleSheetUrl" placeholder="https://docs.google.com/spreadsheets/d/.../pub?output=csv">
                        </div>
                        <button class="btn-save" onclick="importFromGoogleUrl()" style="width: 100%;">
                            Import from URL
                        </button>
                    </div>
                    
                    <div id="pasteTab" class="import-tab-content">
                        <div class="import-instructions">
                            <p><strong>Paste your data:</strong></p>
                            <p>Copy rows from Google Sheets and paste below. Format:</p>
                            <code>Workstream, Task, Owner, Priority, Size, Start, End, Risk</code>
                        </div>
                        <div class="form-group">
                            <label for="pasteData">Paste Data (CSV or Tab-separated)</label>
                            <textarea id="pasteData" rows="8" placeholder="Paste your data here..."></textarea>
                        </div>
                        <button class="btn-save" onclick="importFromPaste()" style="width: 100%;">
                            Import Pasted Data
                        </button>
                    </div>
                    
                    <div class="import-template">
                        <p>üì• <a href="#" onclick="downloadTemplate(); return false;">Download template</a> for the correct format</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast"></div>

    <script src="script.js"></script>
</body>
</html>

